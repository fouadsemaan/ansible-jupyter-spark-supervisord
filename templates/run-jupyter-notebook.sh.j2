#!/usr/bin/env bash

source activate {{jupyter_supervisord_name}}

{% for env_file in jupyter_supervisord_env_files|default([]) %}
source {{env_file}}
{% endfor %}

if [[ -n "${NB_EXECUTABLE}" ]]
then
  if [[ "${NB_EXECUTABLE}" == "true" ]]
  then
    jupyter nbconvert \
          --config={{jupyter_supervisord_profile_py}} \
          --Session.username={{jupyter_supervisord_username}} \
          --execute ${NB_FILE} \
          {{jupyter_supervisord_eff_notebook_dir}}
  else
    echo "NB_EXECUTABLE set but not initialized to true"
  fi
else
  jupyter notebook \
          --config={{jupyter_supervisord_profile_py}} \
          --Session.username={{jupyter_supervisord_username}} \
          {{jupyter_supervisord_eff_notebook_dir}}
fi
